# 7つのソフトウェア設計原則

## 3つの観点で見るソフトウェア品質
1. 合目的性：入出力や計算判断の機能要求を満たす。
2. 安定性：可用性・性能とスケーラビリティ・セキュリティの要求を満たす。
3. 発展性：変更容易性や拡張性

合目的性と安定性はソフトウェアの利用者が判断可能な外部品質です。
発展性は、ソフトウェアの利用者からは判断しにくい内部品質です。

**もっとも重要なソフトウェア品質は発展性**
事業の持続的な成長に貢献できる発展性を持つソフトウェアがビジネス価値を生み出します。
ソフトウェアの発展性が向上すれば、合目的性や安定性も継続的に改善できます。

## 発展性を産みだす7つの設計原則
1. 関心の分離
2. カプセル化
3. 抽象化
4. 疎結合
5. 高凝集
6. 単一定義
7. モジュール化
7つの設計原則の中心にあるのがモジュール化である。

## モジュール化
複雑で大きなソフトウェアを複数のプログラムファイルに分割し、それらを組み合わせて全体をつくりあげるのがモジュール化です。

### モジュール化の2つのアプローチ
1. 型によるモジュール化
2. 手続き的なモジュール

7つの設計原則は、どちらの設計アプローチでも適用可能です。
しかし、型によるモジュール化の設計アプローチと、手続き的なモジュール化の設計アプローチとでは、それぞれの設計原則をどう適用するかの考え方とやり方が大きく異なります。

### 型によるモジュール化
- 型によるプログラミングの分割
- 値の種類ごとに値を使った操作(計算や判断)をグルーピングして一つのモ
  ジュールにまとめるのがオブジェクト指向プログラミングの基本的な考え方
  です。
- 型には組み込み型と、ユーザー定義型がある。
- 独自の型をもモジュールとして作成しそれらのモジュールを組み合わせてア
  プリケーションでをボトムアップに組み立てていくのがオブジェクト指向プ
  ログラミングの基本アプローチ。
- 計算判断のロジックがどのモジュールに書いてあるのかを分かりやすく整理
  できる。
  
### 手続き的なモジュール化
- 「入力ー処理ー出力」という単位のモジュール分割
- 手続き的んあモジュール分割はトップダウンのアプローチ
- 手続き的なモジュールは、大きなデータクラスを受け取り大きなデータクラ
スを返す設計が多くなります。
- 計算や判断のロジックは、受け取ったデータクラスのデータ項目を処理する
手順の一部として記述します。 
- 型によるモジュール分割とは対照的に、異なる値の種類に対する計算判断のロジックが一つのモジュールに混在します。
- 手続き的なモジュール構造では、同じようなデータクラスを受け取れば、同じような計算判断のロジックが複数のモジュールに重複します。
- その結果、ソフトウェアの変更はやっかいで危険になります。
- 重複したコードはソフトウェアの発展性を阻害します。

## 関心の分離
**関心の4現象**
|            | 入出力                 | 計算・判断                       |
|------------|:----------------------:|:--------------------------------:|
| 業務の関心 | 記録、参照、通知、送付 | ビジネスツールに基づく計算・判断 |
| 実装の詳細 | 入出力の実装の詳細     | 計算・判断の実装の詳細           |
|       |               |                       |

### 入出力と計算・判断の分離
### 業務の関心と実装の詳細の分離
ビジネスロジックの複雑さの整理に威力を発揮するのが、カプセル化と抽象化の２つの設計原則です

## カプセル化と抽象化
カプセル化と抽象化は、型によるモジュール構造でアプリケーションを組み立てるための二本柱です。
特に、複雑なビジネスロジックをわかりやすく記述するためには、カプセル化と抽象化の２つの設計原則が威力を発揮します。
### カプセル化
オブジェクト指向プログラミングで、小さな入れ物（クラス）の中にギュッと詰め込むのは、データとそのデータに対する操作です

#### ビジネスロジックのカプセル化
カプセル化が威力を発揮するのは、ビジネスルールに基づく計算・判断のビジネスロジックを記述する時です。　

### 抽象化
モジュールの本質的な特徴とは何か、そして、モジュールの特徴をどう定義すれば役に立つかを考えるための設計原則が抽象化です。

#### データ抽象
データ抽象は、モジュールの分割方針を、手続きではなく型（値の種類）に注目して行う、というアイデアから生まれました。*2 *3
データ抽象、つまり型によるモジュール化がオブジェクト指向プログラミングの根底にある考え方です。

#### ビジネスロジックとデータ抽象
どんな種類のデータに関心があり、そのデータに対してどんな計算や判断を必要としているかを体系的に整理できます。
データの種類に注目して、ビジネスの関心事としての操作に焦点をあわせるデータ抽象のアプローチが、ビジネスロジックを記述するプログラムのモジュール化に効果を発揮します。

手続き的なモジュール構造では、金額データを扱うあちこちのモジュールに計算や判断のロジックが重複しがちです。コードの重複は変更をやっかいで危険にする元凶です。

## 高凝集と疎結合
高凝集と疎結合はモジュールの質を高めるための設計原則です。

関心の分離・カプセル化・データ抽象の三つの設計原則は、モジュールをどう分割するかの指針です。
分割したモジュールの質を判定するための指針が高凝集と疎結合の二つの設計原則です。

### 凝集度
凝集とは切っても切れない関係の要素の集まりです。

モジュールに格納するデータと操作を一つの関心事に凝集させれば、わかりやすく扱いやすいモジュールになります。
そのモジュールの使いどころの判断と使い方が直感的になります。

オブジェクト指向プログラミングの基本プラクティスであるリファクタリングのパターンは、ほとんどが凝集度の低いモジュールを凝集度の高いモジュールに改善するためのパターンです。

### 結合度
結合度はモジュール間の関係性についての指針です。 モジュール間の関係性は、モジュールのインタフェース（外部に公開された仕様）から判断できます。

判断の目安は三つあります。

    小さなインタフェース
    少ないインタフェース
    理解しやすいインタフェース

### 隠された結合性の問題
コードが重複した複数モジュールへの変更作業は、調べるのも、変更を適用するのも、変更の結果を確認するにも、時間がかかります。
このような暗黙の関係性（隠された結合性）はソフトウェアの変更をやっかいで危険にする元凶です。

隠された結合性をなくして、より質の高い疎結合を実現するにはどうすればよいでしょうか？

## 定義の一点性
型によるモジュール化は、関係する計算判断のロジックを値の種類ごとに一か所で定義することを目的としたアプローチです。
オブジェクト指向プログラミングが、変更を楽で安全にしてソフトウェアの発展性を向上できるのは、型によるモジュール化のアプローチが定義の一点性を実現しやすいからです。
